---
import AccessibilityPanel from "../components/AccessibilityPanel.astro";

interface Props {
  title?: string;
  description?: string;
  variant?: "landing" | "interior";
  ogImage?: string;
}
const {
  title = "Bernat Saiz - Data visualization and information design",
  description = "Information designer and data journalist focused on visual storytelling for editorial and civic contexts, turning complex data into clear, structured visuals.",
  variant = "landing",
  ogImage,
} = Astro.props;

const canonicalUrl = Astro.site ? new URL(Astro.url.pathname, Astro.site).href : Astro.url.href;
const imageUrl = ogImage ?? (Astro.site ? new URL("images/SEO%20Card.webp", Astro.site).href : undefined);
---
<!DOCTYPE html>
<html lang="ca">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <title>{title}</title>
    {imageUrl && (
      <>
        <meta property="og:type" content="website" />
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:image" content={imageUrl} />
        <meta property="og:url" content={canonicalUrl} />
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={title} />
        <meta name="twitter:description" content={description} />
        <meta name="twitter:image" content={imageUrl} />
      </>
    )}
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Bai+Jamjuree:wght@400&family=JetBrains+Mono:wght@400&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class:list={[variant === "interior" && "body--interior"]}>
    <a href="#main" class="skip-link">Salta al contingut</a>
    <main id="main" tabindex="-1">
      <slot />
    </main>
    <AccessibilityPanel />
  </body>
</html>

<style is:global>
  :root {
    --content-max: 1040px;
    --content-padding: clamp(1rem, 5vw, 4rem);
    --motion-duration: 0.35s;
    --motion-ease: cubic-bezier(0.25, 0.1, 0.25, 1);
    --motion-ease-out: cubic-bezier(0.16, 1, 0.3, 1);
    --color-text: #eaeaea;
    --color-text-muted: #b3b3b3;
    --color-focus: #ffffff;
    --focus-width: 3px;
    --focus-offset: 3px;
    --line-length-max: 70ch;
    --text-3xs: 0.625rem;
    --text-2xs: 0.75rem;
    --text-xs: 0.8125rem;
    --text-sm: 0.875rem;
    --text-md: 1rem;
    --text-lg: 1.125rem;
    --text-xl: 1.25rem;
    --text-2xl: 1.5rem;
    --text-3xl: 1.875rem;
    --text-4xl: 2.25rem;
    --text-5xl: 3rem;
    --text-display-hero: clamp(2.25rem, 5vw, 4rem);
    --text-display-hero-mobile: clamp(2rem, 10vw, 3.25rem);
    --text-display-page: clamp(1.75rem, 4vw, 2.75rem);
    --text-display-intro: clamp(1.5rem, 3vw, 2rem);
    --text-display-city: clamp(2.25rem, 8vw, 4.25rem);
    --text-display-card: clamp(1.25rem, 2.2vw, 1.75rem);
    --text-sm-fluid: clamp(0.875rem, 1.2vw, 1rem);
    --text-md-fluid: clamp(1rem, 1.6vw, 1.25rem);
    --text-ui-fluid: clamp(1rem, 2.8vw, 1.25rem);
  }

  @media (prefers-contrast: more) {
    :root {
      --color-text-muted: #cccccc;
      --focus-width: 4px;
    }
  }

  /* Panell d'accessibilitat: classes a <html> */
  html.a11y-text-larger { font-size: 118%; }
  html.a11y-text-smaller { font-size: 94%; }
  html.a11y-contrast-aa body { --color-text: #f5f5f5; color: #f5f5f5; }
  html.a11y-contrast-aaa body { --color-text: #fff; color: #fff; }
  html.a11y-monochrome, html.a11y-grayscale { filter: grayscale(1); }
  html.a11y-invert { filter: invert(1) hue-rotate(180deg); }
  html.a11y-focus-strong :focus-visible { outline: 4px solid #ff0 !important; outline-offset: 4px !important; }
  html.a11y-line-height body { line-height: 1.75 !important; }
  html.a11y-line-height p, html.a11y-line-height li { line-height: 1.8 !important; }
  html.a11y-letter-spacing body { letter-spacing: 0.08em !important; }
  html.a11y-line-length main { max-width: var(--line-length-max) !important; margin-left: auto !important; margin-right: auto !important; }
  html.a11y-no-motion, html.a11y-no-motion * { animation-duration: 0.01ms !important; transition-duration: 0.01ms !important; }
  html.a11y-no-smooth-scroll { scroll-behavior: auto !important; }
  html.a11y-touch-targets a, html.a11y-touch-targets button { min-height: 44px !important; min-width: 44px !important; padding: 0.75rem 1rem !important; }

  @media (prefers-reduced-motion: reduce) {
    :root {
      --motion-duration: 0.01ms;
    }
  }

  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  html {
    font-size: 16px;
    scroll-behavior: smooth;
  }

  @media (prefers-reduced-motion: reduce) {
    html {
      scroll-behavior: auto;
    }
  }

  html {
    overflow-x: hidden;
  }

  body {
    margin: 0;
    padding: 0;
    min-height: 100vh;
    background: #000;
    color: #eaeaea;
    font-family: "JetBrains Mono", monospace;
    font-size: var(--text-md);
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    overflow-x: hidden;
  }

  body.body--interior {
    background: #0D0D1A;
  }

  body.theme-light {
    background: #f5f5f5;
    color: #1a1a1a;
  }

  body.theme-light.body--interior {
    background: #fff;
  }

  body.theme-light .section-label,
  body.theme-light .info__label,
  body.theme-light .footer__nav a,
  body.theme-light .footer__copy {
    color: #555;
  }

  body.theme-light .footer__nav a:hover {
    color: #000;
  }

  body.theme-light a {
    color: inherit;
  }

  main {
    min-height: 60vh;
  }

  a {
    color: inherit;
    text-decoration: none;
    cursor: pointer;
  }

  a:hover {
    text-decoration: underline;
  }

  .skip-link {
    position: absolute;
    left: -9999px;
    z-index: 9999;
    padding: 0.75rem 1.25rem;
    background: #fff;
    color: #0D0D1A;
    font-weight: 600;
    text-decoration: none;
    border-radius: 4px;
  }

  .skip-link:focus {
    left: 1rem;
    top: 1rem;
    position: fixed;
    outline: 3px solid #0D0D1A;
    outline-offset: 2px;
  }

  :focus-visible {
    outline: var(--focus-width, 3px) solid var(--color-focus, #fff);
    outline-offset: var(--focus-offset, 3px);
  }

  img {
    max-width: 100%;
    height: auto;
    display: block;
  }

  /* ---- Interior page typography (display = Bai Jamjuree) ---- */
  .body--interior h1 {
    font-family: "Bai Jamjuree", sans-serif;
    font-size: var(--text-display-page);
    font-weight: 400;
    line-height: 1.1;
    letter-spacing: -0.02em;
    margin: 0 0 0.5rem;
    color: #fff;
  }

  .body--interior h2 {
    font-family: "JetBrains Mono", monospace;
    font-size: var(--text-2xs);
    font-weight: 400;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: #666;
    margin: 0 0 1rem;
  }

  .body--interior p {
    font-family: "JetBrains Mono", monospace;
    font-size: var(--text-md);
    line-height: 1.7;
    color: #ccc;
    margin: 0 0 1rem;
  }
</style>
